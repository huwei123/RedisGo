(function(t){function e(e){for(var a,n,o=e[0],_=e[1],d=e[2],l=0,u=[];l<o.length;l++)n=o[l],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&u.push(i[n][0]),i[n]=0;for(a in _)Object.prototype.hasOwnProperty.call(_,a)&&(t[a]=_[a]);c&&c(e);while(u.length)u.shift()();return r.push.apply(r,d||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],a=!0,o=1;o<s.length;o++){var _=s[o];0!==i[_]&&(a=!1)}a&&(r.splice(e--,1),t=n(n.s=s[0]))}return t}var a={},i={app:0},r=[];function n(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=a,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(s,a,function(e){return t[e]}.bind(null,a));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],_=o.push.bind(o);o.push=e,o=o.slice();for(var d=0;d<o.length;d++)e(o[d]);var c=_;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var a=s("64a9"),i=s.n(a);i.a},"128c":function(t,e,s){"use strict";var a=s("726f"),i=s.n(a);i.a},4678:function(t,e,s){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(t){var e=r(t);return s(e)}function r(t){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=r,t.exports=i,i.id="4678"},"56d7":function(t,e,s){"use strict";s.r(e);var a=s("2b0e"),i=s("f23d"),r=(s("202f"),s("bc3a")),n=s.n(r),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{height:"100%"},attrs:{id:"app"}},[s("a-layout",{staticClass:"layout",staticStyle:{height:"100%"},attrs:{id:"components-layout-demo-top"}},[s("a-layout-header",[s("a-row",[s("a-col",{attrs:{span:14}},[s("div",{staticClass:"logo"}),s("a-menu",{style:{lineHeight:"64px"},attrs:{theme:"dark",mode:"horizontal",defaultSelectedKeys:["redis_info"]},on:{click:t.menuClick}},[s("a-menu-item",{key:"redis_info"},[s("a-icon",{attrs:{type:"info-circle"}}),t._v("系统详情")],1),s("a-menu-item",{key:"redis_data"},[s("a-icon",{attrs:{type:"database"}}),t._v("数据信息")],1),s("a-menu-item",{key:"redis_pubsub"},[s("a-icon",{attrs:{type:"swap"}}),t._v("发布订阅")],1),s("a-menu-item",{key:"redis_monitor"},[s("a-icon",{attrs:{type:"dashboard"}}),t._v("性能监控")],1)],1)],1),s("a-col",{attrs:{span:8,offset:"2"}},[s("div",{staticStyle:{"text-align":"right"}},[s("a-select",{staticStyle:{width:"150px",margin:"0 20px"},attrs:{value:t.redis_ip},on:{change:t.change_redis}},t._l(t.containers,(function(e){return s("a-select-option",{key:e.ip,attrs:{value:e.ip}},[t._v(t._s(e.name))])})),1),s("a-dropdown",[s("a-icon",{staticClass:"ant-dropdown-link",staticStyle:{color:"#ffffff","font-size":"22px"},attrs:{type:"setting"}}),s("a-menu",{attrs:{slot:"overlay"},on:{click:t.settingClick},slot:"overlay"},[s("a-menu-item",{key:"about"},[s("a-icon",{attrs:{type:"info-circle"}}),t._v("关于程序")],1),s("a-menu-item",{key:"update"},[s("a-icon",{attrs:{type:"reload"}}),t.update_flag?s("a-badge",{attrs:{status:"error"}},[t._v("更新通知")]):s("span",[t._v("更新通知")])],1),s("a-menu-item",{key:"edit"},[s("a-icon",{attrs:{type:"edit"}}),t._v("连接管理")],1)],1)],1)],1)])],1)],1),s("a-layout-content",{staticStyle:{padding:"10px 50px"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:"redis_monitor"==t.memu_key,expression:"memu_key=='redis_monitor'"}]},[s("Charts",{ref:"charts"})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"redis_data"==t.memu_key,expression:"memu_key=='redis_data'"}]},[s("Data",{ref:"data"})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"redis_info"==t.memu_key,expression:"memu_key=='redis_info'"}]},[s("Infos",{ref:"infos"})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"redis_pubsub"==t.memu_key,expression:"memu_key=='redis_pubsub'"}]},[s("PubSub",{ref:"pubsub"})],1)])],1),s("a-button",{staticClass:"command-botton",attrs:{shape:"circle",icon:"thunderbolt",size:"large"},on:{click:t.show_command}}),s("Update",{ref:"update"}),s("About",{ref:"about"}),s("Manage",{ref:"manage"}),s("CommandLine",{ref:"commandline"})],1)},_=[],d=s("2f62"),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("a-row",[s("a-col",{staticStyle:{"padding-right":"10px"},attrs:{span:16}},[s("a-divider",[t._v("高时延日志")]),s("a-table",{staticStyle:{"word-break":"break-all"},attrs:{rowKey:"id",columns:t.logs_columns,loading:t.logs_loading,dataSource:t.logs_data,pagination:!1,scroll:{y:280}},scopedSlots:t._u([{key:"time",fn:function(e){return[t._v("\n          "+t._s(t.moment(1e3*e).format("YYYY-MM-DD HH:mm:ss"))+"\n        ")]}}])}),s("a-divider",[t._v("客户端列表")]),s("a-table",{attrs:{rowKey:"id",columns:t.clients_columns,loading:t.clients_loading,dataSource:t.clients_data,pagination:{pageSize:50},scroll:{y:258}},scopedSlots:t._u([{key:"time",fn:function(e){return[t._v("\n          "+t._s(t.formatSeconds(e))+"\n        ")]}}])})],1),s("a-col",{attrs:{span:8}},[s("a-collapse",{staticStyle:{"font-size":"15px"},attrs:{accordion:"",activeKey:"1"}},[s("a-collapse-panel",{key:"1"},[s("template",{slot:"header"},[s("a-icon",{attrs:{type:"home"}}),t._v(" 服务端信息 | "+t._s(t.redis_ip))],1),s("a-card",[s("a-card-grid",{staticClass:"gridcard"},[t._v("版本信息: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.info_data.redis_version)+" | "+t._s(t.info_data.arch_bits))])],1),s("a-card-grid",{staticClass:"gridcard"},[t._v("PID | PORT: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.info_data.process_id)+" | "+t._s(t.info_data.tcp_port))])],1),s("a-card-grid",{staticClass:"gridcard"},[t._v("服务模式: "+t._s(t.info_data.redis_mode))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("运行时间:\n              "),s("a-tooltip",{key:t.formatSeconds(t.info_data.uptime_in_seconds),attrs:{title:t.formatSeconds(t.info_data.uptime_in_seconds)}},[t._v("\n                "+t._s(t.formatSeconds(t.info_data.uptime_in_seconds).length>10?t.formatSeconds(t.info_data.uptime_in_seconds).slice(0,10)+"...":t.formatSeconds(t.info_data.uptime_in_seconds))+"\n              ")])],1),s("a-card-grid",{staticClass:"gridcard"},[t._v("执行文件:\n              "),s("a-tooltip",{key:t.info_data.executable,attrs:{title:t.info_data.executable}},[t._v("\n                "+t._s(t.info_data.executable.length>15?t.info_data.executable.slice(0,15)+"...":t.info_data.executable)+"\n              ")])],1),s("a-card-grid",{staticClass:"gridcard"},[t._v("配置文件:\n              "),s("a-tooltip",{key:t.info_data.config_file,attrs:{title:t.info_data.config_file}},[t._v("\n                "+t._s(t.info_data.config_file.length>15?t.info_data.config_file.slice(0,15)+"...":t.info_data.config_file)+"\n                "),s("a-icon",{staticStyle:{"font-size":"16px",color:"cornflowerblue"},attrs:{type:"info-circle"},on:{click:t.get_config}})],1)],1),s("a-card-grid",{staticClass:"gridcard"},[t._v("系统版本:\n              "),s("a-tooltip",{key:t.info_data.os,attrs:{title:t.info_data.os}},[t._v("\n                "+t._s(t.info_data.os.length>15?t.info_data.os.slice(0,15)+"...":t.info_data.os)+"\n              ")])],1)],1)],2),s("a-collapse-panel",{key:"2"},[s("template",{slot:"header"},[s("a-icon",{attrs:{type:"user"}}),t._v(" 客户端信息")],1),s("a-card",[s("a-card-grid",{staticClass:"gridcard"},[t._v("已连接客户端数量: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.info_data.connected_clients))])],1),s("a-card-grid",{staticClass:"gridcard"},[t._v("阻塞客户端数量: "),s("a-tag",{attrs:{color:"orange"}},[t._v(t._s(t.info_data.blocked_clients))])],1)],1)],2),s("a-collapse-panel",{key:"3"},[s("template",{slot:"header"},[s("a-icon",{attrs:{type:"bar-chart"}}),t._v(" 统计信息")],1),s("a-card",[s("a-card-grid",{staticClass:"gridcard"},[t._v("已接受连接数量: "+t._s(t.info_data.total_connections_received))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("已执行命令数量: "+t._s(t.info_data.total_commands_processed))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("总流入数据量: "+t._s(t.info_data.total_net_input_bytes))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("总流出数据量: "+t._s(t.info_data.total_net_output_bytes))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("每秒流入数据量: "+t._s(t.info_data.instantaneous_input_kbps))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("每秒流出数据量: "+t._s(t.info_data.instantaneous_output_kbps))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("每秒执行命令数量: "+t._s(t.info_data.instantaneous_ops_per_sec))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("过期删除键: "+t._s(t.info_data.expired_keys))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("驱逐(evict)键数量: "+t._s(t.info_data.evicted_keys))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("查找键成功次数: "+t._s(t.info_data.keyspace_hits))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("订阅频道数量: "+t._s(t.info_data.pubsub_channels))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("订阅模式数量: "+t._s(t.info_data.pubsub_patterns))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("拒绝连接请求数量: "+t._s(t.info_data.rejected_connections))])],1)],2),s("a-collapse-panel",{key:"4"},[s("template",{slot:"header"},[s("a-icon",{attrs:{type:"hdd"}}),t._v(" 持久信息")],1),s("a-card",[s("a-card-grid",{staticClass:"gridcard"},[t._v("AOF是否打开: "+t._s(t.info_data.aof_enabled))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("AOF文件大小: "+t._s(t.info_data.aof_current_size))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("RDB文件保存时间: "),s("br"),t._v(" "+t._s(t.moment(1e3*t.info_data.rdb_last_save_time).format("YYYY-MM-DD HH:mm:ss")))])],1)],2),s("a-collapse-panel",{key:"5"},[s("template",{slot:"header"},[s("a-icon",{attrs:{type:"table"}}),t._v(" 内存信息")],1),s("a-card",[s("a-card-grid",{staticClass:"gridcard"},[t._v("系统内存: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.info_data.total_system_memory_human))])],1),s("a-card-grid",{staticClass:"gridcard"},[t._v("占用内存: "),s("a-tag",{attrs:{color:"blue"}},[t._v(t._s(t.info_data.used_memory_human))])],1),s("a-card-grid",{staticClass:"gridcard"},[t._v("系统内存占用: "+t._s(t.info_data.used_memory_rss_human))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("内存消耗峰值: "+t._s(t.info_data.used_memory_peak_human))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("内存碎片率: "+t._s(t.info_data.mem_fragmentation_ratio))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("内存分配器: "+t._s(t.info_data.mem_allocator))])],1)],2),s("a-collapse-panel",{key:"6"},[s("template",{slot:"header"},[s("a-icon",{attrs:{type:"laptop"}}),t._v(" 处理器信息")],1),s("a-card",[s("a-card-grid",{staticClass:"gridcard"},[t._v("系统CPU: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.info_data.used_cpu_sys))])],1),s("a-card-grid",{staticClass:"gridcard"},[t._v("用户CPU: "),s("a-tag",{attrs:{color:"blue"}},[t._v(t._s(t.info_data.used_cpu_user))])],1),s("a-card-grid",{staticClass:"gridcard"},[t._v("后台进程系统CPU: "+t._s(t.info_data.used_cpu_sys_children))]),s("a-card-grid",{staticClass:"gridcard"},[t._v("后台进程用户CPU: "+t._s(t.info_data.used_cpu_user_children))])],1)],2),s("a-collapse-panel",{key:"7"},[s("template",{slot:"header"},[s("a-icon",{attrs:{type:"database"}}),t._v(" 键值信息")],1),s("a-card",[t.format_db_nums(t.info_data.db0)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB0: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db0)))])],1):t._e(),t.format_db_nums(t.info_data.db1)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB1: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db1)))])],1):t._e(),t.format_db_nums(t.info_data.db2)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB2: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db2)))])],1):t._e(),t.format_db_nums(t.info_data.db3)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB3: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db3)))])],1):t._e(),t.format_db_nums(t.info_data.db4)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB4: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db4)))])],1):t._e(),t.format_db_nums(t.info_data.db5)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB5: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db5)))])],1):t._e(),t.format_db_nums(t.info_data.db6)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB6: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db6)))])],1):t._e(),t.format_db_nums(t.info_data.db7)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB7: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db7)))])],1):t._e(),t.format_db_nums(t.info_data.db8)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB8: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db8)))])],1):t._e(),t.format_db_nums(t.info_data.db9)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB9: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db9)))])],1):t._e(),t.format_db_nums(t.info_data.db10)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB10: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db10)))])],1):t._e(),t.format_db_nums(t.info_data.db11)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB11: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db11)))])],1):t._e(),t.format_db_nums(t.info_data.db12)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB12: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db12)))])],1):t._e(),t.format_db_nums(t.info_data.db13)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB13: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db13)))])],1):t._e(),t.format_db_nums(t.info_data.db14)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB14: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db14)))])],1):t._e(),t.format_db_nums(t.info_data.db15)>0?s("a-card-grid",{staticClass:"gridcard25"},[t._v("DB15: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(t.format_db_nums(t.info_data.db15)))])],1):t._e()],1)],2)],1)],1)],1),s("a-drawer",{attrs:{width:"560",placement:"right",visible:t.showConfig},on:{close:function(){t.showConfig=!1}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("Redis配置详情")]),s("a-list",{staticStyle:{"max-height":"88vh",overflow:"auto"},attrs:{bordered:"",dataSource:t.configData},scopedSlots:t._u([{key:"renderItem",fn:function(e){return s("a-list-item",{},[s("a",{attrs:{slot:"actions"},slot:"actions"},[t._v(t._s(e.value))]),t._v("\n        "+t._s(e.key)+"\n      ")])}}])})],1)],1)},l=[],u=s("c1df"),p=s.n(u);const m="http:"===location.protocol?"ws:":"wss:";let h="47.52.140.130:8080",y="127.0.0.1:51299",f={local:{base_url:`${location.protocol}//${y}`,ws_url:`${m}//${y}/ws`},dev:{base_url:`${location.protocol}//${h}`,ws_url:`${m}//${h}/ws`},prod:{base_url:location.origin,ws_url:`${m}//${location.host}/ws`}},g="dev";var b={base_url:f[g].base_url,ws_url:f[g].ws_url,myaxios:n.a.create({baseURL:f[g].base_url})};function v(t,e,s=600){return void 0===t&&(t=[]),t.push(e),t.length>s&&t.shift(),t}function k(t){var e=parseInt(t),s=0,a=0;e>60&&(s=parseInt(e/60),e=parseInt(e%60),s>60&&(a=parseInt(s/60),s=parseInt(s%60)));var i=parseInt(e)+"秒";return s>0&&(i=parseInt(s)+"分"+i),a>0&&(i=parseInt(a)+"小时"+i),i}function w(t){try{return"object"==typeof JSON.parse(t)?JSON.parse(t):null}catch(e){return null}}var x={circle_push:v,formatSeconds:k,parse_json:w},j={name:"RedisInfo",data(){return{url:b.base_url,moment:p.a,formatSeconds:x.formatSeconds,showConfig:!1,configData:[],logs_loading:!1,clients_loading:!1,logs_data:[],clients_data:[],logs_columns:[{title:"ID",dataIndex:"id",width:100},{title:"记录时间",dataIndex:"time",width:200,scopedSlots:{customRender:"time"}},{title:"执行时间(微秒)",dataIndex:"time_used",width:150,sorter:(t,e)=>t.time_used-e.time_used,sortDirections:["descend"]},{title:"日志详情",dataIndex:"msg"}],clients_columns:[{title:"ID",dataIndex:"id",width:150},{title:"主机",dataIndex:"addr",width:200},{title:"连接时长",dataIndex:"age",scopedSlots:{customRender:"time"},width:150},{title:"数据库ID",dataIndex:"db",width:150},{title:"订阅频道",dataIndex:"sub",width:150},{title:"最近执行",dataIndex:"cmd",width:150}]}},computed:{...Object(d["d"])(["redis_ip","info_data"])},methods:{...Object(d["c"])(["setRedisInfo"]),get_config(){this.showConfig=!0,this.configData=[];let t="config get *";n.a.get(this.url+`/containers?method=execute&ip=${this.redis_ip}&command=${t}`).then(t=>{let e=t.data.code;if(0===e){let e=t.data.data;for(let t=0;t<e.length;t+=2)if("client-output-buffer-limit"===e[t]){let s=e[t+1].split(" ");this.configData.push({key:`${e[t]}-${s[0]}`,value:`${s[1]} ${s[2]} ${s[3]}`}),this.configData.push({key:`${e[t]}-${s[4]}`,value:`${s[5]} ${s[6]} ${s[7]}`}),this.configData.push({key:`${e[t]}-${s[8]}`,value:`${s[9]} ${s[10]} ${s[11]}`})}else this.configData.push({key:e[t],value:e[t+1]})}})},format_db_nums(t){if(void 0===t)return 0;if(""===t)return 0;let e=t.split(",")[0];return e.split("=")[1]},get_info(){n.a.get(this.url+"/containers?method=info&ip="+this.redis_ip).then(t=>{this.setRedisInfo({info_data:t.data.data})})},get_logs(){this.logs_loading=!0,n.a.get(this.url+"/containers?method=logs&ip="+this.redis_ip).then(t=>{this.logs_data=t.data.data,this.logs_loading=!1})},get_clients(){this.clients_loading=!0,n.a.get(this.url+"/containers?method=clients&ip="+this.redis_ip).then(t=>{this.clients_data=t.data.data,this.clients_loading=!1})},get_redis_infos(){this.get_info(),this.get_logs(),this.get_clients()}}},$=j,S=(s("128c"),s("2877")),C=Object(S["a"])($,c,l,!1,null,"e32df0fe",null),I=C.exports,O=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"data_view"},[s("a-row",{attrs:{type:"flex",justify:"center"}},[s("a-col",{attrs:{span:"7"}},[s("a-row",{attrs:{gutter:8,type:"flex",justify:"space-between"}},[s("a-col",{attrs:{span:"8"}},[s("a-tooltip",{attrs:{title:"数据库选择"}},[s("a-select",{staticStyle:{width:"100%"},attrs:{value:t.redis_db},on:{change:t.change_db}},t._l(t.dbs,(function(e){return s("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1),s("a-col",{attrs:{span:"10"}},[s("a-tooltip",{attrs:{title:"请输入要搜索的Key"}},[s("a-input-search",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入要搜索的Key"},on:{search:function(e){return t.search_keys(!0,!0)}},model:{value:t.search_key,callback:function(e){t.search_key=e},expression:"search_key"}})],1)],1),s("a-col",{staticStyle:{"text-align":"right"},attrs:{span:"6"}},[s("a-button",{attrs:{icon:"plus"},on:{click:t.add_key_click}},[t._v("添加")])],1)],1),s("div",{staticStyle:{"margin-top":"10px"}}),s("a-list",{staticStyle:{"max-height":"80vh",overflow:"auto","background-color":"white"},attrs:{bordered:"",dataSource:t.keys},scopedSlots:t._u([{key:"renderItem",fn:function(e){return s("a-list-item",{on:{click:function(s){return t.click_item(e)}}},[s("a-list-item-meta",[s("a",{attrs:{slot:"title"},slot:"title"},[s("a-tooltip",{key:e["name"],attrs:{title:e["type"]+" 类型: "+e["name"]}},["string"===e["type"]?s("a-tag",{staticClass:"tagstyle",attrs:{color:"green"}},[t._v("String")]):t._e(),"list"===e["type"]?s("a-tag",{staticClass:"tagstyle",attrs:{color:"blue"}},[t._v("List")]):t._e(),"set"===e["type"]?s("a-tag",{staticClass:"tagstyle",attrs:{color:"pink"}},[t._v("Set")]):t._e(),"zset"===e["type"]?s("a-tag",{staticClass:"tagstyle",attrs:{color:"red"}},[t._v("ZSet")]):t._e(),"hash"===e["type"]?s("a-tag",{staticClass:"tagstyle",attrs:{color:"cyan"}},[t._v("Hash")]):t._e(),t._v("\n                "+t._s(e["name"].length>23?e["name"].slice(0,23)+"...":e["name"])+"\n              ")],1)],1)]),s("div",{attrs:{slot:"actions"},slot:"actions"},[t._v("Len: "+t._s(e["len"])+" | TTL: "+t._s(t.formatSeconds(e["ttl"]/1e9)))])],1)}}])}),s("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[s("a-button-group",[t.pre_key_flag?s("a-button",{on:{click:function(e){return t.search_keys(!1,!1)}}},[s("a-icon",{attrs:{type:"left"}}),t._v(" Prev")],1):t._e(),t.next_key_flag?s("a-button",{on:{click:function(e){return t.search_keys(!1,!0)}}},[t._v(" Next"),s("a-icon",{attrs:{type:"right"}})],1):t._e()],1)],1)],1),s("a-col",{attrs:{offset:"1",md:16,xl:16,xxl:12}},[s("a-row",{attrs:{gutter:8,type:"flex",justify:"space-between"}},[s("a-col",{attrs:{span:"8"}},[s("a-tooltip",{attrs:{title:"Key的名称"}},[s("a-input-group",[s("a-input",{staticStyle:{width:"22%"},attrs:{value:t.temp_key_item.type.toUpperCase(),disabled:""}}),s("a-input",{staticStyle:{width:"78%"},attrs:{placeholder:"名称"},on:{pressEnter:t.rename_key},model:{value:t.temp_key_item.name,callback:function(e){t.$set(t.temp_key_item,"name",e)},expression:"temp_key_item.name"}},[s("a-icon",{attrs:{slot:"suffix",type:"check"},on:{click:t.rename_key},slot:"suffix"})],1)],1)],1)],1),s("a-col",{attrs:{span:"3"}},[s("a-tooltip",{attrs:{title:"过期时间, -1 为永久, 单位: 秒"}},[s("a-input",{staticStyle:{width:"100%"},attrs:{placeholder:"过期时间"},on:{pressEnter:t.update_ttl},model:{value:t.temp_key_item.ttl,callback:function(e){t.$set(t.temp_key_item,"ttl",e)},expression:"temp_key_item.ttl"}},[s("a-icon",{attrs:{slot:"suffix",type:"check"},on:{click:t.update_ttl},slot:"suffix"})],1)],1)],1),s("a-col",{attrs:{span:"4"}},[s("a-button-group",{staticStyle:{width:"100%"}},["string"===t.temp_key_item.type?s("a-tooltip",{attrs:{title:"编辑内容"}},[s("a-button",{staticStyle:{width:"33%",color:"blue"},attrs:{icon:"edit"},on:{click:t.edit_value}})],1):t._e(),s("a-tooltip",{attrs:{title:"刷新"}},[s("a-button",{staticStyle:{width:"33%",color:"green"},attrs:{icon:"sync"},on:{click:t.refresh}})],1),s("a-tooltip",{attrs:{title:"删除Key"}},[s("a-button",{staticStyle:{width:"33%",color:"red"},attrs:{icon:"delete"},on:{click:t.rm_key}})],1)],1)],1),s("a-col",{attrs:{span:"5"}},["string"===t.temp_key_item.type?s("a-button-group",[s("a-tooltip",{attrs:{title:"以初始文字形式展示"}},[s("a-button",{staticStyle:{width:"33%"},on:{click:t.show_text}},[t._v("Text")])],1),s("a-tooltip",{attrs:{title:"以Json形式展示"}},[s("a-button",{staticStyle:{width:"33%"},on:{click:t.show_json}},[t._v("Json")])],1),s("a-tooltip",{attrs:{title:"以json压缩形式展示"}},[s("a-button",{staticStyle:{width:"33%"},on:{click:t.show_zip}},[t._v("Zip")])],1)],1):t._e(),s("a-tooltip",{attrs:{title:"请输入要搜索的Key"}},[["hash","set","zset"].includes(t.temp_key_item.type)?s("a-input-search",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入要搜索的Key"},on:{search:function(e){return t.value_search_key_value(!0,!0)}},model:{value:t.value_search_key,callback:function(e){t.value_search_key=e},expression:"value_search_key"}}):t._e()],1)],1),s("a-col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[t.edit_mode?s("a-button",{staticStyle:{width:"48%"},attrs:{type:"primary"},on:{click:t.comform_edit}},[t._v("确认")]):t._e(),t.edit_mode?s("a-button",{staticStyle:{width:"48%"},attrs:{type:"error"},on:{click:t.cancel_edit}},[t._v("取消")]):t._e()],1)],1),s("div",{staticStyle:{"margin-top":"10px"}}),s("div",{staticStyle:{"max-height":"80vh",overflow:"auto","background-color":"white"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.present_spin,expression:"present_spin"}],staticClass:"spin-content"},[s("a-spin",{attrs:{spinning:t.present_spin}})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.present_spin,expression:"!present_spin"}]},["string"===t.temp_key_item.type?s("div",[t.edit_mode?s("a-textarea",{staticStyle:{"max-height":"80vh",overflow:"auto"},attrs:{rows:60,placeholder:"暂无内容"},model:{value:t.temp_key_item.key_value,callback:function(e){t.$set(t.temp_key_item,"key_value",e)},expression:"temp_key_item.key_value"}}):s("div",[t.json_view_flag?s("json-view",{attrs:{data:t.temp_key_item.key_value}}):s("pre",[t._v(t._s(t.temp_key_item.key_value))])],1)],1):t._e(),["list","hash","set","zset"].includes(t.temp_key_item.type)?s("div",[s("a-list",{attrs:{bordered:"",dataSource:t.temp_key_item.key_value},scopedSlots:t._u([{key:"renderItem",fn:function(e,a){return s("a-list-item",{},[s("a-list-item-meta",["hash"===t.temp_key_item.type||"zset"===t.temp_key_item.type?s("a",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e[0]))]):t._e(),s("div",{attrs:{slot:"description"},slot:"description"},[e[2]?s("a-textarea",{attrs:{rows:t.cal_textarea_lines(e[1])},model:{value:e[1],callback:function(s){t.$set(e,1,s)},expression:"item[1]"}}):s("span",[t._v(t._s(e[1]))])],1)]),s("div",{attrs:{slot:"actions"},slot:"actions"},[e[2]?s("div",[s("a",{on:{click:function(e){return t.conform_edit_item_value(a)}}},[t._v("确认")]),s("a-divider",{attrs:{type:"vertical"}}),s("a",{staticStyle:{color:"lightsalmon"},on:{click:function(e){return t.cancel_edit_item_value(a)}}},[t._v("取消")])],1):s("div",[s("a",{on:{click:function(s){return t.format_json(e[1])}}},[t._v("JSON")]),s("a-divider",{attrs:{type:"vertical"}}),s("a",{on:{click:function(e){return t.edit_item_value(a)}}},[t._v("编辑")]),s("a-divider",{attrs:{type:"vertical"}}),s("a",{staticStyle:{color:"lightsalmon"},on:{click:function(e){return t.delete_item_value(a)}}},[t._v("删除")])],1)])],1)}}],null,!1,1342717643)})],1):t._e()])]),s("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},["hash"===t.temp_key_item.type||"set"===t.temp_key_item.type?s("a-button-group",[t.pre_value_page_flag?s("a-button",{on:{click:function(e){return t.value_search_key_value(!1,!1)}}},[s("a-icon",{attrs:{type:"left"}}),t._v(" Prev")],1):t._e(),t.next_value_page_flag?s("a-button",{on:{click:function(e){return t.value_search_key_value(!1,!0)}}},[t._v(" Next"),s("a-icon",{attrs:{type:"right"}})],1):t._e()],1):t._e(),"list"===t.temp_key_item.type?s("a-pagination",{attrs:{defaultPageSize:t.value_count,total:t.temp_key_item.len},on:{change:t.list_page_click},model:{value:t.list_page,callback:function(e){t.list_page=e},expression:"list_page"}}):t._e()],1)],1)],1),s("a-modal",{attrs:{footer:null,destroyOnClose:!0,width:"50vw"},model:{value:t.showJsonModal,callback:function(e){t.showJsonModal=e},expression:"showJsonModal"}},[s("json-view",{staticStyle:{"margin-top":"20px",overflow:"auto","max-height":"72vh"},attrs:{data:t.jsonDataModal}})],1)],1)},z=[],D=s("1b37"),J=s.n(D),N={name:"RedisData",data(){return{url:b.base_url,log:console.log,formatSeconds:x.formatSeconds,row_width:[7,12],redis_db:0,search_key:"",key_cursors:[0],key_count:20,keys:[],present_mode:"Text",value_cursors:[0],value_search_key:"",value_count:20,list_page:1,present_spin:!1,json_view_flag:!1,jsonDataModal:null,showJsonModal:!1,edit_mode:!1,origin_key_item:{name:"",type:"None",len:0,ttl:-1,key_value:"暂无内容"},temp_key_item:{name:"",type:"None",len:0,ttl:-1,key_value:"暂无内容"}}},components:{jsonView:J.a},computed:{...Object(d["d"])(["redis_ip","info_data"]),dbs:function(){let t=[];for(let e=0;e<16;e++)t.push({value:e,label:`DB${e} (${this.format_db_nums(this.info_data["db"+e])} keys)`});return t},pre_key_flag:function(){return this.key_cursors.length>2},next_key_flag:function(){return this.keys.length>=this.key_count},pre_value_page_flag:function(){return this.value_cursors.length>2},next_value_page_flag:function(){return this.temp_key_item.key_value.length>=this.value_count&&0!==this.value_cursors[this.value_cursors.length-1]}},methods:{...Object(d["c"])(["setRedisInfo"]),cal_textarea_lines(t){return parseInt(t.length/100)+1},format_db_nums(t){if(void 0===t)return 0;if(""===t)return 0;let e=t.split(",")[0];return e.split("=")[1]},async change_db(t){this.redis_db=t;const e=await b.myaxios.get(`data?method=select_db&ip=${this.redis_ip}&db=${this.redis_db}`);200===e.status&&e.data&&0===e.data.code&&"OK"===e.data.data&&(this.$message.success("成功切换至DB"+t),await this.search_keys())},async get_info(){const t=await b.myaxios.get("containers?method=info&ip="+this.redis_ip);200===t.status&&t.data&&0===t.data.code&&this.setRedisInfo({info_data:t.data.data})},async search_keys(t=!0,e=!0){t&&(this.key_cursors=[0]),e||(this.key_cursors.pop(),this.key_cursors.pop());let s=this.key_cursors[this.key_cursors.length-1],a=""!==this.search_key?`*${this.search_key}*`:"*";const i=await b.myaxios.get(`data?method=get_keys&ip=${this.redis_ip}&cursor=${s}&match=${a}&count=${this.key_count}`);if(200===i.status&&i.data&&0===i.data.code){let t=i.data.data;this.key_cursors.push(t.cursor),this.keys=null===t.keys?[]:t.keys}},async edit_value(){this.edit_mode=!0,"object"===typeof this.temp_key_item.key_value&&(this.temp_key_item.key_value=JSON.stringify(this.temp_key_item.key_value,null,4))},add_key_click(){this.$message.warning("添加key功能暂未实现, 请耐心等待")},async rm_key(){const t=await b.myaxios.get(`data?method=rm_key&ip=${this.redis_ip}&key=${this.origin_key_item.name}`);200===t.status&&t.data&&0===t.data.code&&1===t.data.data&&(this.$message.success("删除成功"),await this.search_keys(),this.origin_key_item.name="",this.origin_key_item.ttl=-1,this.origin_key_item.key_value="暂无内容",this.temp_key_item.name="",this.temp_key_item.ttl=-1,this.temp_key_item.key_value="暂无内容")},cancel_edit(){this.edit_mode=!1,"Json"===this.present_mode&&(this.temp_key_item.key_value=JSON.parse(this.origin_key_item.key_value))},async comform_edit(){await this.set_string_value(this.temp_key_item.key_value)},async refresh(){await this.get_ttl(),await this.get_key_value(this.origin_key_item.name,this.origin_key_item.type),"Json"===this.present_mode&&(this.temp_key_item.key_value=JSON.parse(this.temp_key_item.key_value))},async rename_key(){const t=await b.myaxios.get(`data?method=rename&ip=${this.redis_ip}&key=${this.origin_key_item.name}&new_name=${this.temp_key_item.name}`);200===t.status&&t.data&&0===t.data.code&&(!0===t.data.data||"OK"===t.data.data?(this.$message.success("重命名成功"),this.origin_key_item.name=this.temp_key_item.name,await this.search_keys()):this.$message.error("重命名失败: "+t.data.data))},async update_ttl(t){const e=await b.myaxios.get(`data?method=update_ttl&ip=${this.redis_ip}&key=${this.origin_key_item.name}&ttl=${t}`);200===e.status&&e.data&&0===e.data.code&&(!0!==e.data.data&&"OK"!==e.data.data||(this.$message.success("更新超时时间成功"),await this.search_keys()))},async get_ttl(){const t=await b.myaxios.get(`data?method=get_ttl&ip=${this.redis_ip}&key=${this.origin_key_item.name}`);200===t.status&&t.data&&0===t.data.code&&(this.origin_key_item.ttl=parseInt(t.data.data/1e9),this.temp_key_item.ttl=parseInt(t.data.data/1e9))},async click_item(t){this.json_view_flag=!1,this.origin_key_item.ttl=parseInt(t.ttl/1e9),this.origin_key_item.type=t.type,this.origin_key_item.name=t.name,this.origin_key_item.len=t.len,this.temp_key_item.ttl=parseInt(t.ttl/1e9),this.temp_key_item.type=t.type,this.temp_key_item.name=t.name,this.temp_key_item.len=t.len,this.value_search_key="",await this.get_key_value(t.name,t.type),this.present_mode="Text"},async value_search_key_value(t=!0,e=!0){let s=""===this.value_search_key?"*":`*${this.value_search_key}*`;await this.get_key_value(this.temp_key_item.name,this.temp_key_item.type,s,t,e)},async list_page_click(t){this.list_page=t,await this.get_key_value(this.temp_key_item.name,this.temp_key_item.type,"",!1)},async get_key_value(t,e,s="*",a=!0,i=!0){if(this.present_spin=!0,"hash"===e||"set"===e||"zset"===e){a&&(this.value_cursors=[0]),i||(this.value_cursors.pop(),this.value_cursors.pop());let r=this.value_cursors[this.value_cursors.length-1];const n=await b.myaxios.get(`data?method=get_key_value&ip=${this.redis_ip}&key=${t}&type=${e}&cursor=${r}&match=${s}&count=${this.value_count}`);if(200===n.status&&n.data&&0===n.data.code){let t=n.data.data;this.present_spin=!1,this.value_cursors.push(t.cursor);let s=[],a=[];if("hash"===e||"zset"===e)for(let e=0;e<t.keys.length-1;e+=2)s.push([t.keys[e],t.keys[e+1],!1]),a.push([t.keys[e],t.keys[e+1],!1]);else if("set"===e)for(let e=0;e<t.keys.length;e+=1)s.push(["",t.keys[e],!1]),a.push(["",t.keys[e],!1]);this.origin_key_item.key_value=s,this.temp_key_item.key_value=a}}else if("list"===e){a&&(this.list_page=1);let s=(this.list_page-1)*this.value_count,i=s+this.value_count-1;const r=await b.myaxios.get(`data?method=get_key_value&ip=${this.redis_ip}&key=${t}&type=${e}&start=${s}&end=${i}`);if(200===r.status&&r.data&&0===r.data.code){this.present_spin=!1;let t=r.data.data,e=[],s=[];for(let a=0;a<t.length;a+=1)e.push(["",t[a],!1]),s.push(["",t[a],!1]);this.origin_key_item.key_value=e,this.temp_key_item.key_value=s}}else{const s=await b.myaxios.get(`data?method=get_key_value&ip=${this.redis_ip}&key=${t}&type=${e}`);200===s.status&&s.data&&0===s.data.code&&(this.present_spin=!1,this.origin_key_item.key_value=null===s.data.data?[]:s.data.data,this.temp_key_item.key_value=null===s.data.data?[]:s.data.data)}},format_json(t){let e=x.parse_json(t);null!==e?(this.jsonDataModal=e,this.showJsonModal=!0):this.$message.error("不支持该类型数据的JSON展示")},show_json(){if(this.edit_mode)if("object"===typeof this.temp_key_item.key_value)this.temp_key_item.key_value=JSON.stringify(this.temp_key_item.key_value,null,4),this.present_mode="Json";else{let t=x.parse_json(this.temp_key_item.key_value);null!==t?(this.temp_key_item.key_value=JSON.stringify(t,null,4),this.present_mode="Json"):this.$message.error("不支持该类型数据的JSON展示")}else{if("object"!==typeof this.temp_key_item.key_value){let t=x.parse_json(this.temp_key_item.key_value);if(null===t)return void this.$message.error("不支持该类型数据的JSON展示");this.temp_key_item.key_value=t,this.present_mode="Json"}this.json_view_flag=!0}},show_zip(){if(this.json_view_flag=!1,"object"===typeof this.temp_key_item.key_value)this.temp_key_item.key_value=JSON.stringify(this.temp_key_item.key_value),this.present_mode="Zip";else{let t=x.parse_json(this.temp_key_item.key_value);null!==t?(this.temp_key_item.key_value=JSON.stringify(t),this.present_mode="Zip"):this.$message.error("不支持该类型数据的JSON展示")}},show_text(){this.json_view_flag=!1,this.temp_key_item.key_value=this.origin_key_item.key_value,this.present_mode="Text"},async set_string_value(t){const e=await b.myaxios.get(`data?method=string_ops&ops=set&ip=${this.redis_ip}&key=${this.temp_key_item.name}&value=${t}`);200===e.status&&e.data&&0===e.data.code&&"OK"===e.data.data&&(this.$message.success("修改成功"),this.edit_mode=!1,"Json"===this.present_mode&&(this.temp_key_item.key_value=JSON.parse(t)),this.origin_key_item.key_value=t)},async push_list_value(t,e,s){const a=await b.myaxios.get(`data?method=list_ops&ops=push&ip=${this.redis_ip}&key=${t}&pos=${e}&value=${s}`);200===a.status&&a.data&&0===a.data.code&&this.log(a.data.data)},async delete_item_value(t){let e=null,s=`ops=delete&&ip=${this.redis_ip}&key=${this.temp_key_item.name}`;if("list"===this.temp_key_item.type){let a=(this.list_page-1)*this.value_count+t;e=await b.myaxios.get(`data?method=list_ops&pos=${a}&${s}`)}else if("hash"===this.temp_key_item.type){let a=this.origin_key_item.key_value[t][0];e=await b.myaxios.get(`data?method=hash_ops&hash_key=${a}&${s}`)}else if("set"===this.temp_key_item.type){let a=this.origin_key_item.key_value[t][1];e=await b.myaxios.get(`data?method=set_ops&set_key=${a}&${s}`)}else if("zset"===this.temp_key_item.type){let a=this.origin_key_item.key_value[t][0];e=await b.myaxios.get(`data?method=zset_ops&zset_key=${a}&${s}`)}200===e.status&&e.data&&0===e.data.code&&(this.$message.success("删除成功"),this.temp_key_item.key_value.splice(t,1),this.origin_key_item.key_value.splice(t,1))},async edit_item_value(t){this.temp_key_item.key_value[t].splice(2,1,!0)},async conform_edit_item_value(t){let e=this.temp_key_item.key_value[t][1],s=`ops=set&&ip=${this.redis_ip}&key=${this.temp_key_item.name}&value=${e}`,a=null;if("list"===this.temp_key_item.type){let e=(this.list_page-1)*this.value_count+t;a=await b.myaxios.get(`data?method=list_ops&pos=${e}&${s}`)}else if("hash"===this.temp_key_item.type){let e=this.origin_key_item.key_value[t][0];a=await b.myaxios.get(`data?method=hash_ops&hash_key=${e}&${s}`)}else if("set"===this.temp_key_item.type){let e=this.origin_key_item.key_value[t][1];a=await b.myaxios.get(`data?method=set_ops&set_key=${e}&${s}`)}else if("zset"===this.temp_key_item.type){let i=this.origin_key_item.key_value[t][0],r=/^[0-9]+.?[0-9]*$/;if(!r.test(e))return void this.$message.warning("Redis的ZSET类型的值只支持数字");a=await b.myaxios.get(`data?method=zset_ops&zset_key=${i}&${s}`)}200===a.status&&a.data&&0===a.data.code&&(this.$message.success("修改成功"),this.temp_key_item.key_value[t].splice(2,1,!1),this.origin_key_item.key_value[t].splice(1,1,this.temp_key_item.key_value[t][1]))},async cancel_edit_item_value(t){this.temp_key_item.key_value[t].splice(2,1,!1),this.temp_key_item.key_value[t].splice(1,1,this.origin_key_item.key_value[t][1])}},mounted(){this.$refs.data_view.width<=900&&(this.row_width=[8,15])}},P=N,R=(s("8e39"),Object(S["a"])(P,O,z,!1,null,"6f01035e",null)),A=R.exports,B=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},U=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticStyle:{"text-align":"center",width:"100%"}},[s("div",{staticStyle:{height:"90vh",width:"96vw"},attrs:{id:"chart"}})])])}],M=s("313e"),E=s.n(M);const T={legend:{},animationThreshold:300,tooltip:{trigger:"axis",axisPointer:{animation:!1}},dataset:{dimensions:["time","instantaneous_input_kbps","instantaneous_output_kbps","used_memory","instantaneous_ops_per_sec","used_cpu_user"],source:[]},grid:[{x:"7%",y:"7%",width:"40%",height:"19%"},{x:"7%",y2:"52%",width:"40%",height:"19%"},{x2:"7%",y:"7%",width:"40%",height:"40%"},{x:"7%",y2:"7%",width:"40%",height:"40%"},{x2:"7%",y2:"7%",width:"40%",height:"40%"}],axisPointer:{link:{xAxisIndex:"all"}},xAxis:[{gridIndex:0,type:"category"},{gridIndex:1,type:"category",position:"top",show:!1},{gridIndex:2,type:"category"},{gridIndex:3,type:"category"},{gridIndex:4,type:"category"}],yAxis:[{gridIndex:0,nameGap:55,nameLocation:"center",name:"上行流量(Kbps/s)"},{gridIndex:1,nameGap:55,nameLocation:"center",name:"下行流量(Kbps/s)",inverse:!0},{gridIndex:2,nameGap:55,nameLocation:"center",name:"内存监控"},{gridIndex:3,nameGap:55,nameLocation:"center",name:"每秒执行操作数)"},{gridIndex:4,nameGap:55,nameLocation:"center",name:"CPU监控"}],series:[{name:"上行流量",type:"line",showSymbol:!1,hoverAnimation:!1,sampling:"average",xAxisIndex:0,yAxisIndex:0},{name:"下行流量",type:"line",showSymbol:!1,hoverAnimation:!1,sampling:"average",xAxisIndex:1,yAxisIndex:1},{name:"内存监控",type:"line",showSymbol:!1,hoverAnimation:!1,sampling:"average",xAxisIndex:2,yAxisIndex:2},{name:"每秒执行操作数",type:"line",showSymbol:!1,hoverAnimation:!1,sampling:"average",xAxisIndex:3,yAxisIndex:3},{name:"CPU监控",type:"line",showSymbol:!1,hoverAnimation:!1,sampling:"average",xAxisIndex:4,yAxisIndex:4}]};let K=null;var L={name:"RedisCharts",data(){return{log:console.log,last_time:{}}},computed:{...Object(d["d"])(["redis_ip","chart_data","chart_ip_data","chart_change_count"])},watch:{chart_change_count(){this.updateCharts()}},methods:{...Object(d["c"])(["initWS"]),resetCharts(){T.dataset.source=this.chart_data[this.redis_ip],void 0===T.dataset.source&&(T.dataset.source=[]),K.setOption(T)},updateCharts(){void 0===this.last_time[this.redis_ip]?(this.last_time[this.redis_ip]=this.chart_ip_data[0],T.dataset.source=this.chart_data[this.redis_ip]):this.last_time[this.redis_ip]!==this.chart_ip_data[0]&&(K.setOption(T),this.log(this.chart_ip_data[0]))}},mounted(){K=E.a.init(document.getElementById("chart")),K.setOption(T)}},H=L,Y=Object(S["a"])(H,B,U,!1,null,"9a49f420",null),W=Y.exports,G=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("a-row",{staticStyle:{"padding-top":"10px"}},[s("a-col",{staticStyle:{"padding-right":"10px"},attrs:{span:16}},[s("div",{staticClass:"redis-output-container"},[s("a-list",{staticStyle:{"background-color":"white"},attrs:{bordered:"",dataSource:t.redis_output[t.redis_ip]},scopedSlots:t._u([{key:"renderItem",fn:function(e,a){return s("a-list-item",{},[s("a-list-item-meta",{attrs:{description:e[1]}},[s("a",{attrs:{slot:"title"},slot:"title"},[t._v("接收通道: "+t._s(e[0]))])]),s("div",{attrs:{slot:"actions"},slot:"actions"},[s("a",{on:{click:function(s){return t.format_json(e[1])}}},[t._v("JSON")]),s("a-divider",{attrs:{type:"vertical"}}),s("a",{staticStyle:{color:"lightsalmon"},on:{click:function(e){return t.delete_pubsub_output(a)}}},[t._v("删除")])],1)],1)}}])},[s("div",{attrs:{slot:"header"},slot:"header"},[s("b",[t._v("Redis输出信息:")]),s("a-tag",{staticStyle:{position:"absolute",right:"24px"},attrs:{color:"red"},on:{click:function(e){return t.delete_pubsub_output(-1)}}},[t._v("清空信息")])],1)])],1)]),s("a-col",{staticStyle:{"padding-top":"8px"},attrs:{span:8}},[s("a-input",{staticStyle:{"margin-bottom":"8px"},attrs:{placeholder:"发布/订阅的Channel"},model:{value:t.pubsub_key,callback:function(e){t.pubsub_key=e},expression:"pubsub_key"}}),s("a-textarea",{staticStyle:{"margin-bottom":"8px"},attrs:{rows:10,placeholder:t.pubsub_msg_placeholder},model:{value:t.pubsub_msg,callback:function(e){t.pubsub_msg=e},expression:"pubsub_msg"}}),s("a-button",{staticStyle:{background:"#108ee9","border-color":"#108ee9"},attrs:{type:"primary"},on:{click:t.publish_msg}},[t._v("发布")]),s("a-button",{staticStyle:{background:"#87d068","border-color":"#87d068","margin-left":"5px"},attrs:{type:"primary"},on:{click:t.subscribe_msg}},[t._v("订阅")]),s("a-divider",[t._v("发布列表")]),s("div",{staticStyle:{"line-height":"2","max-height":"22vh",overflow:"auto"}},[t._l(t.publish_keys[t.redis_ip],(function(e){return[e.length>80?s("a-tooltip",{key:e,attrs:{title:e}},[s("a-tag",{key:e,attrs:{color:"#108ee9",closable:!0,afterClose:function(){return t.handlePubClose(e)}},on:{click:function(s){return t.copyPublishMsg(e)}}},[t._v("\n                            "+t._s(e.slice(0,80)+"...")+"\n                        ")])],1):s("a-tag",{key:e,attrs:{color:"#108ee9",closable:!0,afterClose:function(){return t.handlePubClose(e)}},on:{click:function(s){return t.copyPublishMsg(e)}}},[t._v("\n                        "+t._s(e)+"\n                    ")]),t._v("  \n                ")]}))],2),s("a-divider",[t._v("订阅列表")]),s("div",{staticStyle:{"line-height":"2","max-height":"22vh",overflow:"auto"}},[t._l(t.subscribe_keys_show,(function(e){return[e.length>80?s("a-tooltip",{key:e,attrs:{title:e}},[s("a-tag",{key:e,attrs:{color:"#87d068",closable:!0,afterClose:function(){return t.handleTagClose(e)}},on:{click:function(){t.pubsub_key=e}}},[t._v("\n                            "+t._s(e.slice(0,80)+"...")+"\n                        ")])],1):s("a-tag",{key:e,attrs:{color:"#87d068",closable:!0,afterClose:function(){return t.handleTagClose(e)}},on:{click:function(){t.pubsub_key=e}}},[t._v("\n                        "+t._s(e)+"\n                    ")])]})),t._l(t.subscribe_keys_history_show,(function(e){return[e.length>80?s("a-tooltip",{key:e,attrs:{title:e}},[s("a-tag",{key:e,attrs:{color:"darkgrey",closable:!0,afterClose:function(){return t.handleTagHisClose(e)}},on:{click:function(){t.pubsub_key=e}}},[t._v("\n                            "+t._s(e.slice(0,80)+"...")+"\n                        ")])],1):s("a-tag",{key:e,attrs:{color:"darkgrey",closable:!0,afterClose:function(){return t.handleTagHisClose(e)}},on:{click:function(){t.pubsub_key=e}}},[t._v("\n                        "+t._s(e)+"\n                    ")])]}))],2)],1)],1),s("a-modal",{attrs:{footer:null,destroyOnClose:!0,width:"50vw"},model:{value:t.showJson,callback:function(e){t.showJson=e},expression:"showJson"}},[s("json-view",{staticStyle:{"margin-top":"20px",overflow:"auto","max-height":"72vh"},attrs:{data:t.jsonData}})],1)],1)},F=[],Z={name:"PubSub",data(){return{subscribe_keys_flag:{},publish_keys:{},pubsub_key:"",pubsub_msg:"",pubsub_msg_placeholder:'需要发布的信息, 可以直接放上可读的Json, 例如:\n{\n  "ABC": [\n    "123456",\n    "234567",\n    "345678",\n  ],\n  "DEF": ["567890"]\n}',jsonData:"",showJson:!1}},components:{jsonView:J.a},computed:{...Object(d["d"])(["redis_ip","subscribe_keys","subscribe_keys_history","redis_output"]),subscribe_keys_show:function(){return void 0===this.subscribe_keys[this.redis_ip]?[]:this.subscribe_keys[this.redis_ip]},subscribe_keys_history_show:function(){return void 0===this.subscribe_keys_history[this.redis_ip]?[]:this.subscribe_keys_history[this.redis_ip]}},methods:{...Object(d["c"])(["send_websocket_msg","set_pubsub_keys","remove_pubsub_output"]),format_json(t){let e=x.parse_json(t);null!==e?(this.jsonData=e,this.showJson=!0):this.$message.error("不支持该类型数据的JSON展示")},delete_pubsub_output(t){-1===t?this.remove_pubsub_output({remove_all:!0}):this.remove_pubsub_output({index:t})},publish_msg(){""!=this.redis_ip?""!=this.pubsub_key?b.myaxios.get(`containers?method=publish&ip=${this.redis_ip}&key=${encodeURIComponent(this.pubsub_key)}&msg=${encodeURIComponent(this.pubsub_msg)}`).then(t=>{let e=t.data;0!=e.code?this.$message.error(e.msg):(this.$message.success(`${this.redis_ip} => ${e.msg} 发布成功`),void 0===this.publish_keys[this.redis_ip]&&this.$set(this.publish_keys,this.redis_ip,[]),-1===this.publish_keys[this.redis_ip].indexOf(e.msg+" | "+e.data)&&(this.publish_keys[this.redis_ip].push(e.msg+" | "+e.data),localStorage.setItem("publish_keys",JSON.stringify(this.publish_keys))))}):this.$message.error("请输入Channel再试"):this.$message.error("未检测到有效的Redis连接, 请在设置中添加",10)},subscribe_msg(){""!=this.redis_ip?""!=this.pubsub_key?(void 0===this.subscribe_keys_flag[this.redis_ip]&&this.$set(this.subscribe_keys_flag,this.redis_ip,{}),void 0===this.subscribe_keys_flag[this.redis_ip][this.pubsub_key]?(this.send_websocket_msg({type:2,ip:this.redis_ip,channel:this.pubsub_key,command:"open"}),this.$set(this.subscribe_keys_flag[this.redis_ip],this.pubsub_key,!0)):this.$message.error(`${this.redis_ip} => 已经订阅 ${this.pubsub_key}, 无需重复订阅`)):this.$message.error("请输入Channel再试"):this.$message.error("未检测到有效的Redis连接, 请在设置中添加并刷新页面",10)},copyPublishMsg(t){let e=t.split(" | ");this.pubsub_key=e[0],this.pubsub_msg=e[1]},handlePubClose(t){const e=this.publish_keys[this.redis_ip].filter(e=>e!==t);this.$set(this.publish_keys,this.redis_ip,e),localStorage.setItem("publish_keys",JSON.stringify(this.publish_keys))},handleTagClose(t){this.subscribe_keys_flag[this.redis_ip][t]&&(this.send_websocket_msg({type:2,ip:this.redis_ip,channel:t,command:"close"}),delete this.subscribe_keys_flag[this.redis_ip][t])},handleTagHisClose(t){const e=this.subscribe_keys_history[this.redis_ip].filter(e=>e!==t);this.set_pubsub_keys({redis_ip:this.redis_ip,subscribe_keys_history:e})},onDestroy(){let t=this.subscribe_keys;for(let e in this.subscribe_keys_history)for(let s in this.subscribe_keys_history[e]){let a=this.subscribe_keys_history[e][s];void 0===t[e]&&(t[e]=[],t[e].push(a)),-1===t[e].indexOf(a)&&t[e].push(a)}localStorage.setItem("subscribe_keys",JSON.stringify(t))}},mounted(){window.onbeforeunload=this.onDestroy;let t=localStorage.getItem("publish_keys");null!==t&&(this.publish_keys=JSON.parse(t));let e=localStorage.getItem("subscribe_keys");null!==e&&this.set_pubsub_keys({subscribe_keys_history:JSON.parse(e)})}},q=Z,V=(s("9815"),Object(S["a"])(q,G,F,!1,null,"6245ba10",null)),Q=V.exports,X=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("a-modal",{attrs:{width:"420px",footer:null},model:{value:t.about_flag,callback:function(e){t.about_flag=e},expression:"about_flag"}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("a-icon",{staticStyle:{color:"lightgreen","font-size":"22px"},attrs:{type:"check-circle"}}),t._v(" "+t._s(t.version))],1),s("div",{staticStyle:{"text-align":"center"}},[s("img",{staticStyle:{width:"50%"},attrs:{src:t.pic_src}}),s("p",[t._v("您正在使用免费开源的 "),s("a-tag",{attrs:{color:"green"}},[t._v("RedisGo")])],1),s("p",[t._v("可以扫码关注 "),s("a-tag",{attrs:{color:"red"}},[t._v("公众号")]),t._v("获得最新的消息")],1),s("p",[t._v("如果觉得好用，不妨在  "),s("a",{attrs:{target:"_blank",href:"https://github.com/liuzhuoling2011/RedisGo"}},[s("a-icon",{attrs:{type:"github"}}),t._v("Github")],1),t._v(" 给个 "),s("a-icon",{staticStyle:{color:"sandybrown"},attrs:{type:"star",theme:"filled"}})],1),s("p",[t._v("良好的关注度和参与度有助于开源项目的长远发展~")])])])],1)},tt=[],et={name:"About",data(){return{version:"RedisGo Web V2.0.4",about_flag:!1,pic_src:"http://qiniu.zoranjojo.top/zoranjojo.jpg"}},methods:{showAbout(){this.about_flag=!0}}},st=et,at=Object(S["a"])(st,X,tt,!1,null,"c24ac4e6",null),it=at.exports,rt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("a-modal",{attrs:{footer:null},model:{value:t.show_update,callback:function(e){t.show_update=e},expression:"show_update"}},[t.update_flag?s("div",{attrs:{slot:"title"},slot:"title"},[s("a-icon",{staticStyle:{color:"orange","font-size":"22px"},attrs:{type:"info-circle"}}),t._v(" 可以升级的版本如下, 下载后请替换本程序")],1):s("div",{attrs:{slot:"title"},slot:"title"},[s("a-icon",{staticStyle:{color:"lightgreen","font-size":"22px"},attrs:{type:"check-circle"}}),t._v(" 您目前使用的版本是最新的, 无需更新!")],1),s("a-list",{attrs:{itemLayout:"horizontal",dataSource:t.update_version},scopedSlots:t._u([{key:"renderItem",fn:function(e){return s("a-list-item",{},[s("a-list-item-meta",[s("a",{attrs:{slot:"title",href:e},slot:"title"},[t._v(t._s(e))])])],1)}}])})],1)],1)},nt=[],ot={name:"Update",data(){return{update_version:[],show_update:!1}},computed:{...Object(d["d"])(["update_flag"])},methods:{...Object(d["c"])(["setUpdateFlag"]),showUpdate(){this.show_update=!0},checkUpdate(){b.myaxios.get("system?method=update").then(t=>{if(this.update_version=JSON.parse(t.data.data).data.filename,null===this.update_version||1===this.update_version.length)this.update_version=[];else{this.setUpdateFlag(),this.update_version.shift();for(let t=0;t<this.update_version.length;t++)this.update_version[t]="http://"+this.update_version[t];this.update_version.reverse()}}),b.myaxios.get("system?method=notice").then(t=>{let e="redisgo_notice_time";this.notices=JSON.parse(t.data.data).data;for(let s=0;s<this.notices.length;s++)(null==localStorage[e]||localStorage[e]<this.notices[s].CreatedAt)&&(localStorage.setItem(e,this.notices[s].CreatedAt),this.$notification["success"]({top:80,duration:10,message:"温馨提示",description:this.notices[s].Msg}))})}},mounted(){this.checkUpdate()}},_t=ot,dt=Object(S["a"])(_t,rt,nt,!1,null,"550dda2e",null),ct=dt.exports,lt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("a-drawer",{attrs:{width:"560",placement:"right",visible:t.visible},on:{close:function(){t.visible=!1}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("Redis连接管理 "),s("a-divider",{attrs:{type:"vertical"}}),s("a-button",{staticStyle:{color:"#42b983"},attrs:{icon:"plus"},on:{click:t.add_container}},[t._v("添加连接")])],1),s("a-card",t._l(t.containers,(function(e,a){return s("a-card-grid",{key:a,staticClass:"gridcard100"},[t._v("\n                名称: "),s("a-tag",{attrs:{color:"green"}},[t._v(t._s(e.name))]),s("a-divider",{attrs:{type:"vertical"}}),t._v("\n                IP: "),s("a-tag",{attrs:{color:"blue"}},[t._v(t._s(e.ip))]),s("a-divider",{attrs:{type:"vertical"}}),t._v("\n                端口: "+t._s(e.port)+" "),s("a-divider",{attrs:{type:"vertical"}}),t._v("\n                DB: "+t._s(e.db)+" "),s("br"),s("br"),t._v("\n                密码: "+t._s(e.password)+" "),s("a-divider",{attrs:{type:"vertical"}}),s("a-button",{attrs:{shape:"circle",icon:"edit"},on:{click:function(s){return t.edit_container(e)}}}),s("a-button",{attrs:{shape:"circle",icon:"delete",type:"danger"},on:{click:function(s){return t.delete_container(e.ip)}}})],1)})),1)],1),s("a-drawer",{attrs:{title:t.children_drawl_name,width:"280",visible:t.visible_children},on:{close:function(){t.visible_children=!1}}},["修改连接"==t.children_drawl_name?s("a-input",{attrs:{placeholder:"连接IP",size:"large",disabled:""},on:{pressEnter:t.press_enter},model:{value:t.container_tmp.ip,callback:function(e){t.$set(t.container_tmp,"ip",e)},expression:"container_tmp.ip"}},[s("a-icon",{attrs:{slot:"prefix",type:"api"},slot:"prefix"}),t.container_tmp.ip?s("a-icon",{attrs:{slot:"suffix",type:"close-circle"},on:{click:function(){t.container_tmp.ip=""}},slot:"suffix"}):t._e()],1):s("a-input",{attrs:{placeholder:"连接IP",size:"large"},on:{pressEnter:t.press_enter,change:function(){t.container_tmp.name=t.container_tmp.ip}},model:{value:t.container_tmp.ip,callback:function(e){t.$set(t.container_tmp,"ip",e)},expression:"container_tmp.ip"}},[s("a-icon",{attrs:{slot:"prefix",type:"api"},slot:"prefix"}),t.container_tmp.ip?s("a-icon",{attrs:{slot:"suffix",type:"close-circle"},on:{click:function(){t.container_tmp.ip=""}},slot:"suffix"}):t._e()],1),s("a-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"连接名称",size:"large"},on:{pressEnter:t.press_enter},model:{value:t.container_tmp.name,callback:function(e){t.$set(t.container_tmp,"name",e)},expression:"container_tmp.name"}},[s("a-icon",{attrs:{slot:"prefix",type:"user"},slot:"prefix"}),t.container_tmp.name?s("a-icon",{attrs:{slot:"suffix",type:"close-circle"},on:{click:function(){t.container_tmp.name=""}},slot:"suffix"}):t._e()],1),s("a-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"密码",size:"large"},on:{pressEnter:t.press_enter},model:{value:t.container_tmp.password,callback:function(e){t.$set(t.container_tmp,"password",e)},expression:"container_tmp.password"}},[s("a-icon",{attrs:{slot:"prefix",type:"warning"},slot:"prefix"}),t.container_tmp.password?s("a-icon",{attrs:{slot:"suffix",type:"close-circle"},on:{click:function(){t.container_tmp.password=""}},slot:"suffix"}):t._e()],1),s("a-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"端口",size:"large"},on:{pressEnter:t.press_enter},model:{value:t.container_tmp.port,callback:function(e){t.$set(t.container_tmp,"port",e)},expression:"container_tmp.port"}},[s("a-icon",{attrs:{slot:"prefix",type:"appstore"},slot:"prefix"}),t.container_tmp.port?s("a-icon",{attrs:{slot:"suffix",type:"close-circle"},on:{click:function(){t.container_tmp.port=""}},slot:"suffix"}):t._e()],1),s("a-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"DB",size:"large"},on:{pressEnter:t.press_enter},model:{value:t.container_tmp.db,callback:function(e){t.$set(t.container_tmp,"db",e)},expression:"container_tmp.db"}},[s("a-icon",{attrs:{slot:"prefix",type:"hdd"},slot:"prefix"}),t.container_tmp.db?s("a-icon",{attrs:{slot:"suffix",type:"close-circle"},on:{click:function(){t.container_tmp.db=""}},slot:"suffix"}):t._e()],1),s("a-button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",loading:t.visible_children_loading},on:{click:t.press_enter}},[t._v("确认")])],1)],1)},ut=[],pt={name:"Manage",data(){return{container_tmp:{ip:"",name:"",password:"",port:6379,db:0,status:0},visible:!1,visible_children:!1,visible_children_loading:!1,children_drawl_name:"新增连接"}},computed:{...Object(d["d"])(["redis_ip","containers"])},methods:{...Object(d["c"])(["setRedisIPName","addContainer","deleteContainer"]),showManage(){this.visible=!0},add_container(){this.visible_children=!0,this.children_drawl_name="新增连接",this.container_tmp.ip="",this.container_tmp.password="",this.container_tmp.name="",this.container_tmp.port=6379,this.container_tmp.db=0},edit_container(t){this.visible_children=!0,this.children_drawl_name="修改连接",this.container_tmp.ip=t.ip,this.container_tmp.password=t.password,this.container_tmp.name=t.name,this.container_tmp.port=t.port,this.container_tmp.db=t.db},delete_container(t){b.myaxios.get("containers?method=delete&ip="+t).then(e=>{let s=e.data.code;if(0==s){if(this.$message.success("成功删除Redis连接"),t===this.redis_ip){let e=!1;for(let s in this.containers)if(this.containers[s].ip!==t){this.setRedisIPName({redis_ip:this.containers[s].ip}),e=!0;break}e||this.$message.error("未检测到有效的Redis连接, 请在右上角的设置中添加",10)}this.deleteContainer({ip:t})}})},upload_add(){this.visible_children_loading=!0;let t=`ip=${this.container_tmp.ip}&port=${this.container_tmp.port}&db=${this.container_tmp.db}&name=`+encodeURIComponent(this.container_tmp.name)+"&password="+encodeURIComponent(this.container_tmp.password);b.myaxios.get("containers?method=add&"+t).then(t=>{this.visible_children_loading=!1;let e=t.data;0!=e.code?this.$message.error(e.msg):(this.addContainer({ip:this.container_tmp.ip,container:e.data}),this.$message.success("添加成功"),this.visible_children=!1,1===Object.keys(this.containers).length&&this.setRedisIPName({redis_ip:this.container_tmp.ip,redis_name:this.container_tmp.name}))})},upload_edit(){this.visible_children_loading=!0;let t=`ip=${this.container_tmp.ip}&port=${this.container_tmp.port}&db=${this.container_tmp.db}&name=`+encodeURIComponent(this.container_tmp.name)+"&password="+encodeURIComponent(this.container_tmp.password);b.myaxios.get("containers?method=edit&"+t).then(t=>{this.visible_children_loading=!1;let e=t.data;0!=e.code?this.$message.error(e.msg):(this.addContainer({ip:this.container_tmp.ip,container:e.data}),this.$message.success("修改成功"),this.visible_children=!1)})},press_enter(){"修改连接"===this.children_drawl_name?this.upload_edit():this.upload_add()}}},mt=pt,ht=(s("9bf8"),Object(S["a"])(mt,lt,ut,!1,null,"4ae22048",null)),yt=ht.exports,ft=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("a-drawer",{attrs:{height:"509",placement:"bottom",visible:t.command_visible},on:{close:function(){t.command_visible=!1}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("Redis终端 (请不要执行带阻塞性质的命令 例如: BLPOP, SUBSCRIBE)")]),s("pre",{staticStyle:{height:"350px","white-space":"pre-wrap","word-wrap":"break-word"},attrs:{id:"redis_command_output"}},[t._v(t._s(t.redis_command_output))]),s("a-input-search",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"请输入执行的命令"},on:{search:t.execute_command},model:{value:t.redis_command,callback:function(e){t.redis_command=e},expression:"redis_command"}},[s("a-button",{attrs:{slot:"enterButton",type:"primary"},slot:"enterButton"},[t._v("执行")])],1)],1)],1)},gt=[],bt={name:"CommandLine",data(){return{redis_command:"",redis_command_output:"",command_visible:!1}},computed:{...Object(d["d"])(["redis_ip"])},methods:{showCommand(){this.command_visible=!0},async execute_command(){const t=await b.myaxios.get(`containers?method=execute&ip=${this.redis_ip}&command=${this.redis_command}`);if(200===t.status&&t.data&&0===t.data.code){let e=t.data.data;Array.isArray(e)&&(e=e.join(", ")),this.redis_command_output+=`${p()().format("YYYY-MM-DD HH:mm:ss")}\t${e}\n`,setTimeout(()=>{const t=document.getElementById("redis_command_output");t.scrollTop=t.scrollHeight},100)}}}},vt=bt,kt=Object(S["a"])(vt,ft,gt,!1,null,"a0639f6a",null),wt=kt.exports,xt={name:"app",components:{Infos:I,Data:A,Charts:W,PubSub:Q,About:it,Update:ct,Manage:yt,CommandLine:wt},data(){return{memu_key:"",info_data_flags:{}}},computed:{...Object(d["d"])(["redis_ip","update_flag","containers"])},methods:{...Object(d["c"])(["setRedisIPName","initWS","send_websocket_msg"]),...Object(d["b"])(["initContainers"]),async menuClick(t){this.memu_key=t.key,""!==this.redis_ip?"redis_info"===this.memu_key?this.$refs.infos.get_redis_infos():"redis_data"===this.memu_key?(await this.$refs.data.get_info(),await this.$refs.data.search_keys()):"redis_monitor"===this.memu_key?(this.websocket_get_redis_info(),this.$refs.charts.resetCharts()):this.memu_key:this.$message.error("未检测到有效的Redis连接, 请在右上角的设置中添加",10)},settingClick(t){"about"===t.key?this.$refs.about.showAbout():"update"===t.key?this.$refs.update.showUpdate():"edit"===t.key&&this.$refs.manage.showManage()},websocket_get_redis_info(){void 0===this.info_data_flags[this.redis_ip]&&(this.send_websocket_msg({type:1,ip:this.redis_ip}),this.info_data_flags[this.redis_ip]=!0)},async change_redis(t){this.setRedisIPName({redis_ip:t}),"redis_monitor"===this.memu_key?(this.websocket_get_redis_info(),this.$refs.charts.resetCharts()):"redis_info"===this.memu_key?this.$refs.infos.get_redis_infos():"redis_data"===this.memu_key&&(await this.$refs.data.get_info(),await this.$refs.data.search_keys())},show_command(){this.$refs.commandline.showCommand()}},async created(){this.initWS(),await this.initContainers(),this.menuClick({key:"redis_info"});try{document.body.removeChild(document.getElementById("spinner"))}catch(t){}},mounted(){}},jt=xt,$t=(s("034f"),Object(S["a"])(jt,o,_,!1,null,null,null)),St=$t.exports;function Ct(t,e){const s=t.msg,a=JSON.parse(t.data);e.info_data=a,void 0===e.chart_data[s]&&(e.chart_data[s]=[["time","instantaneous_input_kbps","instantaneous_output_kbps","used_memory","instantaneous_ops_per_sec","used_cpu_user"]]);let i=[p()().format("HH:mm:ss"),a["instantaneous_input_kbps"],a["instantaneous_output_kbps"],a["used_memory"]/1024,a["instantaneous_ops_per_sec"],a["used_cpu_user"]];e.chart_data[s]=x.circle_push(e.chart_data[s],i),e.redis_ip===s&&(e.chart_ip_data=i,e.chart_change_count+=1)}function It(t,e){const s=t.subscribe_keys_history[t.redis_ip].filter(t=>t!==e);a["a"].set(t.subscribe_keys_history,t.redis_ip,s)}function Ot(t,e){const s=JSON.parse(t.data);if(0!=s.type)if(1==s.type)Ct(s,e);else if(2==s.type){if(0==s.status)return a["a"].prototype.$message.success(`${e.redis_ip} => ${s.msg} 订阅成功`),void 0===e.subscribe_keys[e.redis_ip]&&a["a"].set(e.subscribe_keys,e.redis_ip,[]),-1===e.subscribe_keys[e.redis_ip].indexOf(s.msg)&&e.subscribe_keys[e.redis_ip].push(s.msg),void It(e,s.msg);if(-1==s.status){let t=s.msg;a["a"].prototype.$message.success(`${t} => ${s.data} 取消订阅成功`);const i=e.subscribe_keys[t].filter(t=>t!==s.data);return void a["a"].set(e.subscribe_keys,t,i)}a["a"].set(e.redis_output,e.redis_ip,x.circle_push(e.redis_output[e.redis_ip],[s.msg,s.data]))}}a["a"].use(d["a"]);var zt=new d["a"].Store({state:{log:console.log,redis_ip:"",redis_name:"",websocket:null,websocket_ping:null,containers:{},info_data:{},info_data_map:{},update_flag:!1,chart_data:{},chart_ip_data:[],chart_change_count:0,subscribe_keys:{},subscribe_keys_history:{},redis_output:{}},mutations:{setUserInfo(t,e){t.login=e.login,t.user=e.user},setRedisIPName(t,e){t.redis_ip=e.redis_ip,void 0!==e.redis_name&&(t.redis_name=e.redis_name)},setContainers(t,e){t.containers=e.containers},addContainer(t,e){a["a"].set(t.containers,e.ip,e.container)},deleteContainer(t,e){a["a"].delete(t.containers,e.ip)},setRedisInfo(t,e){t.info_data=e.info_data,t.info_data_map[t.redis_ip]=e.info_data},setUpdateFlag(t){t.update_flag=!0},set_pubsub_keys(t,e){if(void 0!==e.redis_ip)void 0!==e.subscribe_keys&&a["a"].set(t.subscribe_keys,e.redis_ip,e.subscribe_keys),void 0!==e.subscribe_keys_history&&a["a"].set(t.subscribe_keys_history,e.redis_ip,e.subscribe_keys_history);else{if(void 0!==e.subscribe_keys)for(let s in e.subscribe_keys)a["a"].set(t.subscribe_keys,s,e.subscribe_keys[s]);if(void 0!==e.subscribe_keys_history)for(let s in e.subscribe_keys_history)a["a"].set(t.subscribe_keys_history,s,e.subscribe_keys_history[s])}},remove_pubsub_output(t,e){e.remove_all?a["a"].set(t.redis_output,t.redis_ip,[]):a["a"].delete(t.redis_output[t.redis_ip],e.index)},send_websocket_msg(t,e={type:0}){t.websocket.send(JSON.stringify(e))},initWS(t){let e=new WebSocket(b.ws_url);e.onopen=()=>{t.log("WebSocket连接成功"),t.websocket_ping=setInterval(t.send_websocket_msg,6e4)},e.onerror=()=>a["a"].prototype.$message.error("WebSocket连接发生错误, 请刷新页面"),e.onclose=e=>{t.log(`WebSocket连接关闭 (${e.data})`),t.websocket=null,clearTimeout(t.websocket_ping),t.websocket_ping=null,a["a"].prototype.$notification["error"]({message:"WebSocket连接断开, 请按Ctrl+F5刷新页面",duration:0})},e.onmessage=e=>Ot(e,t),t.websocket=e}},actions:{async initContainers({commit:t}){let e="";const s=await b.myaxios.get("containers?method=list");if(200===s.status&&s.data&&0===s.data.code){let a=s.data.data;for(let s in a)""===e&&(e=a[s]["ip"],t("setRedisIPName",{redis_ip:e,redis_name:a[s]["name"]}));""!==e&&t("setContainers",{containers:a})}}}});a["a"].use(i["a"]),a["a"].config.productionTip=!1,window.axios=n.a.create({baseURL:b.base_url}),new a["a"]({store:zt,render:t=>t(St)}).$mount("#app")},"5ae9":function(t,e,s){},"64a9":function(t,e,s){},"726f":function(t,e,s){},"874a":function(t,e,s){},"8e39":function(t,e,s){"use strict";var a=s("aea5"),i=s.n(a);i.a},9815:function(t,e,s){"use strict";var a=s("874a"),i=s.n(a);i.a},"9bf8":function(t,e,s){"use strict";var a=s("5ae9"),i=s.n(a);i.a},aea5:function(t,e,s){}});
//# sourceMappingURL=app.8732f3dd.js.map